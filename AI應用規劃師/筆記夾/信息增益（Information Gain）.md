### **信息增益（Information Gain）與決策樹模型的關聯**

#### **1. 信息增益的基本概念**

在決策樹（Decision Tree）模型中，我們需要選擇合適的特徵來進行數據分類。信息增益（Information Gain，簡稱 IG）是一種衡量 **某個特徵對數據分類能力** 的指標，決策樹通常會選擇 **信息增益最高** 的特徵作為節點來劃分數據。

信息增益的計算基於 **熵（Entropy）**，即衡量數據的不確定性。當數據的熵較高時，表示數據分布混亂；當熵較低時，表示數據比較純淨。

---

#### **2. 熵（Entropy）的計算公式**

熵（Entropy）用來衡量一個系統的混亂程度，其數學公式為：

![[Entropy.png]]

##### **舉例：**

假設一個數據集有 10 個樣本，其中：

- 6 個樣本屬於 **類別 A**
- 4 個樣本屬於 **類別 B**

則其熵為：

![[Entropy Sample.png]]

如果數據集內的所有樣本都屬於同一類別（例如 10 個樣本都是 A），則熵為 0，表示數據完全純淨。

---

#### **3. 信息增益（Information Gain）的計算公式**

當我們使用某個特徵 XXX 來對數據集 SSS 進行劃分時，信息增益的計算公式為：

![[Information Gain.png]]

##### **舉例：**

假設我們有一個數據集 SSS，其中有 10 個樣本，初始熵為 **0.97**。現在我們用某個特徵 XXX 來分割數據：

- 若 X=0X = 0X=0 時，S0S_0S0​ 包含 6 個樣本，其中 4 個屬於 A，2 個屬於 B，則 H(S0)=0.92H(S_0) = 0.92H(S0​)=0.92。
- 若 X=1X = 1X=1 時，S1S_1S1​ 包含 4 個樣本，其中 2 個屬於 A，2 個屬於 B，則 H(S1)=1.00H(S_1) = 1.00H(S1​)=1.00。

假設 S0S_0S0​ 和 S1S_1S1​ 的比例分別為 0.60.60.6 和 0.40.40.4，則信息增益為：

IG(S,X)=0.97−(0.6×0.92+0.4×1.00)IG(S, X) = 0.97 - (0.6 \times 0.92 + 0.4 \times 1.00)IG(S,X)=0.97−(0.6×0.92+0.4×1.00) =0.97−(0.552+0.4)=0.018= 0.97 - (0.552 + 0.4) = 0.018=0.97−(0.552+0.4)=0.018

若比較其他特徵的 IG，選擇 IG **最大** 的特徵來作為決策節點。

---

#### **4. 決策樹如何使用信息增益**

決策樹（如 **ID3 算法**）使用信息增益來選擇最佳劃分特徵，步驟如下：

1. 計算整個數據集的熵 H(S)H(S)H(S)。
2. 對數據集的每個特徵 XXX：
    - 根據該特徵的不同取值，將數據分割為多個子集。
    - 計算分割後的熵 H(Sv)H(S_v)H(Sv​)。
    - 計算該特徵的 **信息增益** IG(S,X)IG(S, X)IG(S,X)。
3. 選擇 **信息增益最大** 的特徵作為決策節點，進行分裂。
4. 對每個子節點重複上述步驟，直到：
    - **所有樣本屬於同一類別**（熵為 0）。
    - **沒有特徵可用**（停止分裂）。

---

#### **5. 信息增益的優缺點**

**✅ 優點：**

- 直觀且計算簡單。
- 能夠有效選擇分類能力最強的特徵。

**❌ 缺點：**

- **偏向於選擇取值較多的特徵**（因為這樣能讓熵降低更多）。
    - 例如，若某個特徵有 100 個不同的值，它可能會被優先選擇，即使它對分類幫助不大。
    - **解決方案：** 使用 **信息增益比（Gain Ratio）**，它會對特徵值數量較多的特徵進行懲罰。

---

#### **6. 相關考點**

- **熵的定義與計算公式** ![[Entropy Definition.png]]
- **信息增益的計算公式** ![[Information Gain formula.png]]
- **如何使用信息增益來選擇決策樹的最佳分裂特徵**
- **信息增益的缺點與改進方法（如信息增益比）**

---

### **7. 總結**

- 信息增益是 **決策樹** 選擇最佳劃分特徵的重要指標。
- **熵（Entropy）** 衡量數據的混亂程度，數據越混亂，熵越高。
- **信息增益（IG）** 衡量特徵對於降低不確定性的能力，信息增益越大，該特徵越適合作為決策節點。
- **ID3 決策樹算法** 使用信息增益來選擇分裂特徵。
- 信息增益可能偏向於選擇取值較多的特徵，因此可以使用 **信息增益比** 作為改進方案。

熟悉這些概念後，你可以更好地理解決策樹的運作方式，並應用在實際的機器學習任務中！